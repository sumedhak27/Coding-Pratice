// https://godbolt.org/#z:OYLghAFBqd5TKALEBjA9gEwKYFFMCWALugE4A0BIEAZgQDbYB2AhgLbYgDkAjF%2BTXRMiAZVQtGIHgBYBQogFUAztgAKAD24AGfgCsp5eiyahUAUgBMAIUtXyKxqiIEh1ZpgDC6egFc2TEABmAHZydwAZAiZsADk/ACNsUikLHnIAB3QlYhcmL19/INDM7OchSOi4tkTknlT7bEcyphEiFlIifL8AkIam3Nb2ogrYhKSUtKU2jq7C3qmhkaqaiYBKe3QfUlROLktAqNRfHABqM0CPFynSbHZz3DMtAEF9w%2BPsM4vrqOAAOiR7o8Xs8fNkTCdWBwlOkWDsTlNMOcbM8gUcWEolCdWqQfmdgsiniciSdUEh2gAqE7xHw0JFA4nwggAL2wAH0iIyWXTngzsiz2SSWDDUMQAJ7cwkndI%2BeL0AioEBA%2BnE7E/CAYJhTElk0iU66fAAiEJ89Ho6SIpFWZnxyoZRL5H3ORrAYH15wAYictCcQPCLYwmBBrlbAgS7cTxMKxYaTi63YFPTwfZzsBLw0TqTQY9EAO7a9pmACsVkjsLFRYNafT1yYqHSoogmfIfooKZDYeJ1srKJ5xIA9H2Seh6ySSKRbViLWqNVrVSZLAA2FurZNz4BBi2/TMr602YLd4GSokDk5sdAANw%2BTjIE7XEDXi8Xy%2BTmY3pC3NPWKbfvwdX9LIpEA21y/ABYo7javbhiBmbZiaZoWlW0Gbg6MZaEhdogWBQExjwGFdkqUEnCeGAjui2TAEwJzDkkLBjreU7zhYS40aQdFkDG96McAz67hOvI5kKb7NuSRBIAQSjtvxxI3EQWxUaJ4lKPh%2B6EUeJznugBCYFKoJIKy8SwgA1uqOokhBHbhgQWZBsyjqBJWDmClGQEWdJ4bYaKJzkk6JwWBh6b5rqQ4jr5uZBUWJZCmWQEVgF1YWrW9bqsOorNk2bbxdBgnpI2NLNqRopSURgU4IwRCpsWFYheKobuXiB6BZmkUOrYbWFkavnmHVREET26madpUrDgZxkQBZDoALSTXSqn9QyAB%2Bd5uSVxLWSceU0Faq3hmV2AVZF1XNT16l9YeDJrtR6S0WOZzWBtM4cg%2BzG8ZB6kMiRmwcucHg/XdFjiKa2A6bYV03TeFgWJ8v0XCc7j0Flk44uCNzKSdgWo7%2BdkxmJEkzYEuCoaDIGtej6aY55MaY6Tll2pjsFhdgeakgWxYU9FgHih1iM1nWDb0/lJy40o%2BO4Blwui3%2BPOJXzEAC1moMS/cDrNjBgsk3ZxXvf2g4YD430XH9lgWKTlaQ9Df3U9jP1G5DBVCk6xsW7D7MuV5Nuw/DiMnoIpAbVEHIEGhSInEHlvYEoWNcqGodtdY23a8eg4MnrBswx4Jzy5FBDVR7GdO8b3u619zsZ17ZPhrJ8mnhe2ByxHWsMmdE40Di7jUdctxsE%2BrHsX7ecbVkFpdz3%2BsFUIs7cU%2BkkYa3BDtxJw93C9ve3YCBP%2B53y9LlEzbPUuM8Vycc/t4NOlKDlXHI8A09pEjPzTxYWsESdQJn/Cl/7/Cd9f0oT94rTC%2BQklA8A/DQVWFgwGN2JEA3KICo7YAgQg6B9pL7wM8kgzyz85qHiHjcbeYM2Jr0NrDCAeCR4rzHkOTUT0p4vUkgAicX1fg5hxBVIMYDVbIIwlXUgVEvoSmbs8Re%2BDu4r2ukQji69cCbyXmIneTA950IPitdSIiu4gBACoYQpAvLaItA2KIKDQ42TjMwAxCcMb7WrlEDCAcITYHUEQDCOZxKMA2hAaITiYxRF%2BMAfa40Vwul8pNJMj4XpxiIJgTREloSwjrl4ogqxVGBUjtKJQ%2BlDKoBMok4xZ0GS8KorY1%2BOCgT2LYCwKI41GFERPJdOgpApgxHYKmV%2BtTBwNKaS0mMxslB%2BGBgCSGGFLpGC6RwHpkMADSJojLtCYDnIZR9RlEGaRwX46TMljTAHsCwgRtnGOWas7A6yRpZJMsY1OpcTiHO6QPcutN6kEEaSslpGERRUWkcfJ5YzWm00uQPTpLzxl3KYJgBGbT1J1O4t/CZFgyAEGAFECQhcj5QuvvCCwEAzyXiDDwZJGFPr6yub0vCDkC4kIziA4ldsMWO3NgPP%2BVz7lqQutCqlvljbwsRawBGiyHlsv8kfRlvlsV1xAc/Ii/yKX/RAXSqGDKwnSuNhAuVVzhXSuZfNHW99wQVTYOkAlusoifAeBvPVBrUWDkumwbSYLYivMtaeW1jAjk42wPq4Z0KaDwVdb5QFvr7oF3pfdG5HA3klwBT625GrQXgoJBOQpXpBE4K4Oseg3BCz8ACFwHQ5B0DcF%2BtYYmmxtiOl2XwcgRBtCpvWEZEAhZAi/B4AuCwABOZiWgAAcwRCyttbVoHthhuDSCzdWvN3B%2BBKBAFoSt1b1hwFgCgDA%2BqGBJEoNQZd6RV3JGAHUCwAgGAVUadQeIY74hIt0dwCty6ODCAAPJMHoKKMdOAKkmEkDm/ghAbhOAIJeKdn6wjqGwKgfWuxc0B0aGOuU8Q2K6K8DgMdU42BXtTQIIwwAlAADV545jvddbNFbBDCDEBITgMg5DCGUGoTQgH9BpCMCYNAcc7AwanZAdYw5mgAcmuaJA%2BDMCTsaCB5obhQWzACGkCIURRjVHGGkEoOQhASYMIp5oSwxi1D6CJgY0xOjeG6AYBwOmhCDA6BpuTWmFgzAM4USYemLMrDxRsLYOwDDD12HwNNGbR2AfzVwdQnaFyTQXNIE4wBUCoBOHUX4UMICFpsNYZs%2BBiBSPLc2LwK7GD93LasfgVbP3JPIHW6QC5fidpCAOwIra6jSC0FoVtgQh1cBHeQbNub/OTunbOwr3muAWH4ChhchZfihZkAuLQPAG08AHYWUI7X%2BCdZ6zoediAIAoEcSB/WZB10QHaJh1QxhGgiCQOgHMhH%2BCboYHRXIh3oj0BO2di75ArvZZALuu2r2kh3v1o987Y7NuoCeKQTDE6gMgdaIQAIIh%2BmYCQJR0QgNyOyGI4oFQGgx30cMMYUwLHDAEHiOx8aebzS5AA5Oktbn7NQ7u8d07/3AMedQ%2BQVhQpUN9czW1sd/ncDAdA7dQLwXQvhci9FyBcWEu2GS4QNeuX8tzvWEgW4OBkjE/TS1wbQRpC/ECIWTtDbW2dtK529tdXCxc782DqdM6Csrb64EXzHWwe25reQS8jTcggGkEAA%3D

#include <iostream>
#include <string.h>

using namespace std;

class String {
    char* buf;
    size_t size;
    size_t capacity;
  public:

    String(const char* str = nullptr){
        size = !str ? 0 : strlen(str);
        capacity = !str ? 1 : size;
        buf = new char[capacity];
        strncpy(buf, str, size);
    }

    // copy ctor
    String(const String& str) : String(str.buf) {}

    // move ctor
    String(String&& str) : buf(str.buf), size(str.size), capacity(str.capacity) {
        str.buf = nullptr;
        str.size = 0;
        str.capacity = 1;
    }

    // copy assign operator
    String& operator = (String str) {
        swap(str, *this);
        return *this;
    }

    void push_back(char c) {
        if (size == capacity) {
            capacity *= 2;
            char* copy = new char[capacity];
            strncpy(copy, buf, size);
            swap(buf, copy);
            delete[] copy;
        }
        buf[size++] = c;
    }

    void pop_back() {size--;}

    ~String() {
        if (buf)
            delete[] buf;
    }

    String operator + (const String& str) {
        // cout << "called + operator" << endl;
        String res;
        res.size = this->size + str.size;
        res.capacity = res.size;
        res.buf = new char[res.capacity];
        strncpy(res.buf, this->buf, this->size);
        strncpy(res.buf + this->size, str.buf, str.size);
        // cout << "size=" << res.size << ", cap=" << res.capacity << endl;
        // for (int i = 0; i < res.size; i++)
        //     cout << res.buf[i] << " ";
        // cout << endl;
        return move(res);
    }

    friend ostream& operator << (ostream& out, const String& s);
    friend istream& operator >> (istream& in, String& s);
    friend void swap(String& s1, String& s2);
};

void swap(String& s1, String& s2) {
    swap(s1.buf, s2.buf);
    swap(s1.size, s2.size);
    swap(s1.capacity, s2.capacity);
}

ostream& operator << (ostream& out, const String& s) {
    out.write(s.buf, s.size);
    return out;
}

istream& operator >> (istream& in, String& s) {
    istream::sentry sentry(in);
    if (!sentry)
        return in;
    int next;
    while ((next = in.get()) != -1 && !std::isspace(next)) {
        s.push_back(next);
    }
    return in;
}

int main() {
    // String firstName;

    // firstName = "sumedh";
    String lastName = "Kulkarni";
    lastName.push_back('#');
    lastName.pop_back();
    cout << lastName << endl;
    String firstName;
    cin >> firstName;
    cout << firstName << endl;

    // String s1 = "original";
    // String s2(move(s1));
    // cout << "s1=" << s1 << ", s2=" << s2 << endl;

    String s1 = "original";
    String s2;
    s2 = move(s1);

    cout << "s1=" << s1 << ", s2=" << s2 << endl;

    // String temp;
    // cin >> temp;
    // String middleName;
    // middleName = temp;
    String fullName = firstName + " " + lastName;
    cout << fullName << endl;

    return 0;
}
